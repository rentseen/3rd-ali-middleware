final stage of 3rd tianchi middleware competation
